(global.webpackJsonp=global.webpackJsonp||[]).push([["components/wm-poster/wm-poster"],{1543:function(e,t,n){(function(e){var a=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,c=a(n("2eee")),i=a(n("c973")),o={name:"wm-poster",props:{CanvasID:{Type:String,default:"PosterCanvas"},imgSrc:{Type:String,default:""},QrSrc:{Type:String,default:""},Title:{Type:String,default:""},TitleColor:{Type:String,default:"#333333"},LineType:{Type:[String,Boolean],default:!0},PriceTxt:{Type:String,default:"99.99"},PriceColor:{Type:String,default:"#e31d1a"},OriginalTxt:{Type:String,default:"199.99"},OriginalColor:{Type:String,default:"#bac0c5"},Width:{Type:String,default:690},CanvasBg:{Type:String,default:"#ffffff"},Referrer:{Type:String,default:"quitter推荐给你"},ViewDetails:{Type:String,default:"长按或扫描识别二维码"}},data:function(){return{canvasW:0,canvasH:0,canvasImgSrc:"",ctx:null}},methods:{OnCanvas:function(){var t=this;return(0,i.default)(c.default.mark((function n(){var a,i,o,l,u,s,f,p,d,x,g,m,T;return c.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r.ctx=e.createCanvasContext(r.CanvasID,t),a=e.upx2px(r.Width),i=e.upx2px(30),o=e.upx2px(180),l=0,n.next=5,r.getImageInfo({imgSrc:r.imgSrc});case 5:return u=n.sent,n.next=8,r.getImageInfo({imgSrc:r.QrSrc});case 8:s=n.sent,f=[u.width,u.height],p=[s.width,s.height],d=a-0,console.log("imgW",d,f),f[0]!=d&&(f[1]=Math.floor(d/f[0]*f[1]),f[0]=d),p[0]!=o&&(p[1]=Math.floor(o/p[0]*p[1]),p[0]=o),r.canvasW=a,r.canvasH=f[1]+p[1]+240,r.ctx.setFillStyle(r.CanvasBg),r.ctx.fillRect(0,0,a,r.canvasH),r.ctx.drawImage(u.path,0,0,f[0],f[1]),r.ctx.setFontSize(e.upx2px(32)),r.ctx.setFillStyle(r.TitleColor),x=0,g=f[1]+3*i,m=1,T=0;case 26:if(!(T<r.Title.length)){n.next=48;break}if(!((l+=r.ctx.measureText(r.Title[T]).width)>f[0])){n.next=44;break}if(2!=m||!r.LineType){n.next=37;break}return r.ctx.fillText(r.Title.substring(x,T-8)+"...",i,g),l=0,x=T,m++,n.abrupt("break",48);case 37:r.ctx.fillText(r.Title.substring(x,T),i,g),l=0,g+=20,x=T,m++;case 42:n.next=45;break;case 44:T==r.Title.length-1&&(r.ctx.fillText(r.Title.substring(x,T+1),i,g),l=0);case 45:T++,n.next=26;break;case 48:g+=e.upx2px(70),r.ctx.setFillStyle("#bac0c5"),r.ctx.setFontSize(e.upx2px(24)),r.ctx.fillText("方言类别：闽南语  分类：童谣",i,g),g+=e.upx2px(90),r.ctx.drawImage(s.path,(f[0]-p[0])/2,g,p[0],p[1]),g+=p[1]+40,r.ctx.setFillStyle("#666666"),r.ctx.setTextAlign("center"),r.ctx.setFontSize(e.upx2px(24)),r.ctx.fillText(r.ViewDetails,p[0]/2,g),setTimeout((function(){r.ctx.draw(!0,(function(e){r.getNewImage()}))}),600);case 60:case"end":return n.stop()}}),n)})))()},getImageInfo:function(t){return(0,i.default)(c.default.mark((function n(){var a;return c.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=t.imgSrc,n.abrupt("return",new Promise((function(t,n){e.getImageInfo({src:a,success:function(e){t(e)},fail:function(e){n(e)}})})));case 2:case"end":return n.stop()}}),n)})))()},getNewImage:function(){e.canvasToTempFilePath({canvasId:r.CanvasID,quality:1,complete:function(e){console.log(e.tempFilePath),r.$emit("success",e)}},this)}},mounted:function(){(r=this).OnCanvas()}};t.default=o}).call(this,n("543d").default)},"1a8d":function(e,t,n){n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){}));var a=function(){this.$createElement;this._self._c},r=[]},"1d61":function(e,t,n){n.r(t);var a=n("1543"),r=n.n(a);for(var c in a)["default"].indexOf(c)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(c);t.default=r.a},"507d":function(e,t,n){},ab1d:function(e,t,n){var a=n("507d");n.n(a).a},b1f2:function(e,t,n){n.r(t);var a=n("1a8d"),r=n("1d61");for(var c in r)["default"].indexOf(c)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(c);n("ab1d");var i=n("f0c5"),o=Object(i.a)(r.default,a.b,a.c,!1,null,"db66ced0",null,!1,a.a,void 0);t.default=o.exports}}]),(global.webpackJsonp=global.webpackJsonp||[]).push(["components/wm-poster/wm-poster-create-component",{"components/wm-poster/wm-poster-create-component":function(e,t,n){n("543d").createComponent(n("b1f2"))}},[["components/wm-poster/wm-poster-create-component"]]]);